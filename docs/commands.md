---
title: (Legacy) Commands Reference
---
## Legacy Documentation Notice

This page has moved to the Starlight documentation site at `/commands`.

Content deprecated here to prevent divergence. Consult the generated site for up‑to‑date command details.

Examples:

```bash
cp-ai-wizard scan
cp-ai-wizard scan --json > scan.json
cp-ai-wizard scan -vv --no-exit-code
```

Delta Reporting:

If a previous run exists (`last_scan.json` in evidence dir), added and removed finding IDs are reported.

## advise

Generate hardening / remediation advice from current findings.

Synopsis:

```bash
cp-ai-wizard advise [--json] [--provider PROVIDER]
```

Options:

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `--json` | flag | false | Emit JSON array of advice strings |
| `--provider` | string | _(env or none)_ | Override AI provider for enrichment (future enhancement) |

Examples:

```bash
cp-ai-wizard advise
cp-ai-wizard advise --json | jq length
```

## explain

Produce a natural language summary of current findings (optionally AI-enriched).

Synopsis:

```bash
cp-ai-wizard explain [--provider PROVIDER] [--model MODEL] [--max-tokens N] [--json]
```

Options:

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `--provider` | string | `openai` | AI provider (`openai`, `anthropic`, `none`) |
| `--model` | string | _(provider default)_ | Specific model override |
| `--max-tokens` | int | 400 | Max completion tokens (approx) |
| `--json` | flag | false | Include reasoning / transcript JSON |

Example:

```bash
cp-ai-wizard explain --provider openai --max-tokens 250
```

If provider keys are missing, output degrades to simple summarization fallback.

## agent

Run a ReAct-style reasoning loop issuing internal tool calls.

Synopsis:

```bash
cp-ai-wizard agent "Investigate suspicious processes" [--provider PROVIDER] [--model MODEL] [--steps N] [--verbose] [--json]
```

Arguments / Options:

| Name | Type | Default | Description |
|------|------|---------|-------------|
| `query` | argument | required | User objective / question |
| `--provider` | string | `openai` | Provider (same semantics as explain) |
| `--model` | string | _(provider default)_ | Model override |
| `--steps` | int | 6 | Max tool reasoning iterations |
| `--verbose` | flag | false | Print intermediate steps (tool outputs) |
| `--json` | flag | false | Emit full transcript JSON |

Examples:

```bash
cp-ai-wizard agent "Summarize high severity items"
cp-ai-wizard agent "List suspect cron entries" --steps 3 --verbose
```

## remediate

Apply limited, explicit remediation actions for recommended findings.

Synopsis:

```bash
cp-ai-wizard remediate [--finding ID] [--delete] [--kill] [--preserve]
```

Semantics:

1. Always performs a fresh scan first.
2. Builds a remediation plan selecting only findings whose `recommended_action` is compatible with provided flags.
3. Executes plan (currently removal of files / killing processes) with optional evidence preservation.

Options:

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `--finding` | string | "" | Limit to a specific finding id |
| `--delete` | flag | false | Allow file removal actions |
| `--kill` | flag | false | Allow process kill actions |
| `--preserve` | flag | false | Copy evidence before destructive execution |

Examples:

```bash
cp-ai-wizard remediate --delete --kill --preserve
cp-ai-wizard remediate --finding 123e4567 --delete
```

Output JSON:

```json
{
	"summary": "Applying 1 actions",
	"results": [
		{"finding_id":"...","action":"remove","success":true,"message":"removed","changed":true}
	]
}
```

Safety:

- No destructive action without explicit flag.
- Only allowlisted path prefixes are considered for deletion (see `configuration.md`).

## shell

Interactive mini shell for repeated quick operations.

Synopsis:

```bash
cp-ai-wizard shell
```

Supported commands inside shell prompt:

| Command | Action |
|---------|--------|
| `scan` | Run scanners and display table |
| `advise` | Show advice list |
| `explain` | AI summary (provider openai hardcoded currently) |
| `quit` / `exit` | Leave shell |

Useful for exploratory triage in a terminal session without re-typing full CLI invocations.

## JSON Output Stability

JSON arrays / objects are stable-ordered for compatibility with diffing tools. Future fields may be added; consumers should ignore unknown keys.

<!-- AUTOGENERATED-COMMANDS-START -->
<!-- Will be populated by scripts/generate_command_docs.py -->
<!-- AUTOGENERATED-COMMANDS-END -->

## Error Handling & Exit Codes Summary

Currently only `scan` sets structured exit codes. Other commands return 0 unless an internal error or explicit `typer.Exit(code=1)` (e.g., unknown finding id in `remediate`).

## Automation Tips

Example: run scan and fail CI if high or critical findings appear:

```bash
cp-ai-wizard scan --json --exit-code
severity=$?
if [ $severity -ge 2 ]; then
	echo "High or Critical findings detected" >&2
	exit 1
fi
```

---

See also: `installation.md`, `configuration.md`, and upcoming advanced sections for AI & remediation deep dives.
